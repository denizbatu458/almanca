<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Oyun D√ºnyasƒ±</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
<style>
  :root {
    --bg:#020617; --card:#1e293b;
    --accent:#ff4b4b; --accent2:#ff8a8a; --ok:#10b981;
    --border:rgba(255,255,255,0.1); --text:#f8fafc; --muted:#94a3b8;
  }
  * { box-sizing: border-box; }
  body { 
    margin:0; font-family:'Inter', sans-serif; background: var(--bg); color: var(--text); 
    min-height: 100vh; overflow-x: hidden;
  }

  header { 
    padding: 20px; border-bottom: 1px solid var(--border); background: rgba(15, 23, 42, 0.8);
    backdrop-filter: blur(10px); position: sticky; top: 0; z-index: 100; text-align: center;
    display: flex; justify-content: space-between; align-items: center;
  }

  /* SE√áƒ∞M EKRANI */
  .selection-screen {
    max-width: 1000px; margin: 40px auto; padding: 20px;
    display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 20px;
  }
  .game-card {
    background: var(--card); border: 1px solid var(--border); padding: 30px;
    border-radius: 24px; text-align: center; cursor: pointer; transition: 0.3s;
  }
  .game-card:hover { transform: translateY(-10px); border-color: var(--accent); background: rgba(255,75,75,0.05); }
  .game-card i { font-size: 40px; display: block; margin-bottom: 15px; }

  /* MODLAR */
  .mode-section { display: none; padding: 20px; max-width: 800px; margin: 0 auto; animation: fadeIn 0.4s; }
  .mode-section.active { display: block; }
  @keyframes fadeIn { from { opacity:0; transform:translateY(10px); } to { opacity:1; transform:translateY(0); } }

  /* ADMIN PANEL */
  #adminPanel {
    display: none; max-width: 700px; margin: 10px auto; padding: 20px;
    background: rgba(255, 75, 75, 0.05); border: 1px dashed var(--accent); border-radius: 20px;
  }
  .admin-flex { display: flex; gap: 10px; flex-wrap: wrap; }
  input { flex: 1; background: #0f172a; border: 1px solid var(--border); color: white; padding: 12px; border-radius: 10px; outline: none; }

  /* ADAM ASMACA */
  .hangman-box { text-align: center; background: var(--card); padding: 30px; border-radius: 24px; border: 1px solid var(--border); }
  .word-display { 
    font-size: 42px; letter-spacing: 12px; margin: 30px 0; font-family: monospace; 
    color: #ffffff; text-shadow: 0 0 10px rgba(255, 75, 75, 0.5); font-weight: 800;
  }
  .keyboard { display: grid; grid-template-columns: repeat(auto-fit, minmax(45px, 1fr)); gap: 8px; margin-top: 20px; }
  .key { 
    padding: 12px 5px; background: #0f172a; border: 1px solid #334155; 
    border-radius: 10px; cursor: pointer; color: #fff; font-weight: bold;
  }
  .key.correct { background: var(--ok) !important; border-color: var(--ok); }
  .key.wrong { background: #334155 !important; opacity: 0.3; cursor: default; }

  /* HAFIZA OYUNU */
  .memory-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; }
  .mem-card { height: 110px; background: var(--card); border-radius: 12px; cursor: pointer; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 13px; border: 1px solid var(--border); text-align: center; padding: 5px; }
  .mem-card.flipped { background: var(--accent); color: white; }
  .mem-card.matched { background: var(--ok); color: white; opacity: 0.6; }

  /* AVCI OYUNU */
  #gameArea { width: 100%; height: 50vh; background: rgba(0,0,0,0.2); border-radius: 20px; position: relative; overflow: hidden; border: 1px solid var(--border); }
  .floating-word { position: absolute; background: var(--card); border: 2px solid var(--accent); padding: 10px 20px; border-radius: 50px; font-weight: 800; cursor: pointer; white-space: nowrap; }

  .back-nav { margin-bottom: 20px; display: inline-flex; align-items: center; gap: 10px; cursor: pointer; color: var(--accent2); font-weight: 800; padding: 10px; border-radius: 10px; background: rgba(255,255,255,0.05); }
  .btn-main { background: var(--accent); color: white; border: none; padding: 12px 25px; border-radius: 12px; cursor: pointer; font-weight: bold; }
  
  .exp-display { background: var(--ok); color: #000; padding: 5px 12px; border-radius: 8px; font-weight: 800; font-size: 12px; }
</style>
</head>
<body>

<header>
  <strong style="font-size: 24px; letter-spacing: -1px;">üéÆ Oyun D√ºnyasƒ±</strong>
  <div id="userExp" class="exp-display">EXP: 0</div>
</header>

<div id="selectionScreen" class="selection-screen">
  <div class="game-card" onclick="switchMode('hangman')"><i>üòµ</i><h3>Adam Asmaca</h3><p>Harf tahmin et!</p></div>
  <div class="game-card" onclick="switchMode('imgMatch')"><i>üñºÔ∏è</i><h3>G√∂rsel Bilgi</h3><p>Resmi tanƒ±!</p></div>
  <div class="game-card" onclick="switchMode('memory')"><i>üß†</i><h3>Hafƒ±za</h3><p>Kartlarƒ± e≈üle≈ütir!</p></div>
  <div class="game-card" onclick="switchMode('catcher')"><i>üéØ</i><h3>Avcƒ±</h3><p>Kelimeleri yakala!</p></div>
</div>

<div id="adminPanel">
  <div class="admin-flex">
    <input id="deInp" placeholder="Almanca...">
    <input id="trInp" placeholder="T√ºrk√ße...">
    <input id="imgInp" placeholder="Resim URL (G√∂rsel oyun i√ßin)">
    <button class="btn-main" onclick="saveNewWord()">Kaydet</button>
  </div>
</div>

<section id="hangmanSection" class="mode-section">
  <div class="back-nav" onclick="showSelection()">‚Üê Men√ºye D√∂n</div>
  <div class="hangman-box">
    <div id="hangmanLives" style="font-size:20px; margin-bottom:10px;"></div>
    <div id="wordDisplay" class="word-display"></div>
    <div id="hangmanHint" style="color:var(--muted); margin-bottom:20px;"></div>
    <div class="keyboard" id="keyboard"></div>
  </div>
</section>

<section id="imgMatchSection" class="mode-section">
  <div class="back-nav" onclick="showSelection()">‚Üê Men√ºye D√∂n</div>
  <div class="hangman-box">
    <div class="img-box" id="matchImgBox">Resim Y√ºkleniyor...</div>
    <div id="optionsGrid" style="display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-top:20px;"></div>
  </div>
</section>

<section id="memorySection" class="mode-section">
  <div class="back-nav" onclick="showSelection()">‚Üê Men√ºye D√∂n</div>
  <div class="memory-grid" id="memoryContainer"></div>
</section>

<section id="catcherSection" class="mode-section">
  <div class="back-nav" onclick="showSelection()">‚Üê Men√ºye D√∂n</div>
  <div style="text-align:center; margin-bottom:10px; font-size:24px; color:var(--accent); font-weight:800;" id="catcherScore">Puan: 0</div>
  <div id="gameArea"></div>
</section>

<script>
const KEY_WORDS = "vocabulary_bank_v1";
const KEY_SESSION = "session_student_id";
let currentWord, guessedLetters, lives, catcherScore = 0, memoryFlipped = [];

const sessId = localStorage.getItem(KEY_SESSION);
const isAdmin = sessId === "admin";
if(isAdmin) document.getElementById("adminPanel").style.display = 'block';

// --- MERKEZƒ∞ PUAN Sƒ∞STEMƒ∞ (EXP) ---
function addExp(amount) {
  if(!sessId || isAdmin) return;
  let currentExp = parseInt(localStorage.getItem("game_exp_" + sessId)) || 0;
  currentExp += amount;
  localStorage.setItem("game_exp_" + sessId, currentExp);
  updateExpUI();
}

function updateExpUI() {
  const exp = localStorage.getItem("game_exp_" + sessId) || 0;
  document.getElementById("userExp").textContent = "EXP: " + exp;
}
updateExpUI();

function getWords() {
  return JSON.parse(localStorage.getItem(KEY_WORDS)) || [
    {id:1, de:"Apfel", tr:"Elma", img:"https://cdn-icons-png.flaticon.com/512/415/415733.png"},
    {id:2, de:"Hund", tr:"K√∂pek", img:"https://cdn-icons-png.flaticon.com/512/616/616408.png"},
    {id:3, de:"Buch", tr:"Kitap", img:"https://cdn-icons-png.flaticon.com/512/2702/2702134.png"},
    {id:4, de:"Auto", tr:"Araba", img:"https://cdn-icons-png.flaticon.com/512/741/741407.png"}
  ];
}

function showSelection() {
  document.querySelectorAll('.mode-section').forEach(s => s.classList.remove('active'));
  document.getElementById('selectionScreen').style.display = 'grid';
}

function switchMode(mode) {
  document.getElementById('selectionScreen').style.display = 'none';
  document.querySelectorAll('.mode-section').forEach(s => s.classList.remove('active'));
  document.getElementById(mode + 'Section').classList.add('active');
  if(mode === 'hangman') initHangman();
  if(mode === 'imgMatch') initImgMatch();
  if(mode === 'memory') initMemory();
  if(mode === 'catcher') initCatcher();
}

// --- ADAM ASMACA ---
function initHangman() {
  const bank = getWords();
  currentWord = bank[Math.floor(Math.random() * bank.length)];
  guessedLetters = []; lives = 5;
  const kb = document.getElementById("keyboard"); kb.innerHTML = "";
  "ABC√áDEFGƒûHIƒ∞JKLMNO√ñPRS≈ûTU√úVYZ".split("").forEach(l => {
    const b = document.createElement("button"); b.className = "key"; b.innerText = l;
    b.onclick = () => {
      if(b.classList.contains("correct") || b.classList.contains("wrong")) return;
      if(currentWord.de.toUpperCase().includes(l)) { b.classList.add("correct"); guessedLetters.push(l); }
      else { b.classList.add("wrong"); lives--; }
      updateHangmanUI();
    };
    kb.appendChild(b);
  });
  updateHangmanUI();
}

function updateHangmanUI() {
  let display = ""; let won = true;
  currentWord.de.split("").forEach(char => {
    if(guessedLetters.includes(char.toUpperCase())) display += char + " ";
    else { display += "_ "; won = false; }
  });
  document.getElementById("wordDisplay").innerText = display;
  document.getElementById("hangmanHint").innerText = "Anlamƒ±: " + currentWord.tr;
  document.getElementById("hangmanLives").innerText = "Can: " + "‚ù§Ô∏è".repeat(lives);
  if(won) { 
    addExp(20); // Adam asmaca bitince 20 EXP
    alert("Tebrikler! +20 EXP"); 
    initHangman(); 
  }
  else if(lives <= 0) { alert("Kaybettin! Kelime: " + currentWord.de); initHangman(); }
}

// --- G√ñRSEL Bƒ∞LGƒ∞ ---
function initImgMatch() {
  const bank = getWords().filter(w => w.img);
  if(bank.length < 4) return alert("En az 4 resimli kelime gerekli!");
  const correct = bank[Math.floor(Math.random() * bank.length)];
  document.getElementById("matchImgBox").innerHTML = `<img src="${correct.img}" style="max-height:200px">`;
  let opts = [correct];
  while(opts.length < 4) {
    let r = bank[Math.floor(Math.random() * bank.length)];
    if(!opts.find(x => x.id === r.id)) opts.push(r);
  }
  opts.sort(() => Math.random() - 0.5);
  const grid = document.getElementById("optionsGrid"); grid.innerHTML = "";
  opts.forEach(o => {
    const b = document.createElement("button"); b.className = "option-btn"; b.innerText = o.de;
    b.onclick = () => { 
        if(o.id === correct.id) { 
            addExp(15); 
            alert("Doƒüru! +15 EXP"); 
            initImgMatch(); 
        } else alert("Yanlƒ±≈ü!"); 
    };
    grid.appendChild(b);
  });
}

// --- HAFIZA ---
function initMemory() {
  const bank = getWords().slice(-8);
  let cards = [];
  bank.forEach((w,i) => { cards.push({t:w.de, id:i}, {t:w.tr, id:i}); });
  cards.sort(() => Math.random() - 0.5);
  const cont = document.getElementById("memoryContainer"); cont.innerHTML = "";
  memoryFlipped = [];
  cards.forEach(c => {
    const d = document.createElement("div"); d.className = "mem-card"; d.innerText = "?";
    d.onclick = () => {
      if(memoryFlipped.length < 2 && !d.classList.contains("flipped")) {
        d.innerText = c.t; d.classList.add("flipped"); memoryFlipped.push({d, id:c.id});
        if(memoryFlipped.length === 2) {
          if(memoryFlipped[0].id === memoryFlipped[1].id) {
            addExp(5); // Her e≈üle≈üme 5 EXP
            memoryFlipped.forEach(x => x.d.classList.add("matched"));
            memoryFlipped = [];
          } else {
            setTimeout(() => { memoryFlipped.forEach(x => { x.d.innerText = "?"; x.d.classList.remove("flipped"); }); memoryFlipped = []; }, 1000);
          }
        }
      }
    };
    cont.appendChild(d);
  });
}

// --- AVCI ---
function initCatcher() {
  const area = document.getElementById("gameArea"); area.innerHTML = ""; catcherScore = 0;
  document.getElementById("catcherScore").innerText = "Puan: 0";
  for(let i=0; i<4; i++) spawnCatcherWord();
}
function spawnCatcherWord() {
  const bank = getWords(); const w = bank[Math.floor(Math.random()*bank.length)];
  const d = document.createElement("div"); d.className = "floating-word"; d.innerText = w.de;
  d.style.left = Math.random()*80 + "%"; d.style.top = Math.random()*80 + "%";
  d.onclick = () => {
    d.innerText = w.tr; d.style.background = "var(--ok)"; 
    catcherScore += 10;
    addExp(2); // Her kelime yakalama 2 EXP (Hƒ±zlƒ± toplandƒ±ƒüƒ± i√ßin az)
    document.getElementById("catcherScore").innerText = "Puan: " + catcherScore;
    setTimeout(() => { d.remove(); spawnCatcherWord(); }, 600);
  };
  document.getElementById("gameArea").appendChild(d);
}

function saveNewWord() {
  const de = document.getElementById("deInp").value, tr = document.getElementById("trInp").value, img = document.getElementById("imgInp").value;
  if(!de || !tr) return;
  const words = getWords(); words.push({id:Date.now(), de, tr, img});
  localStorage.setItem(KEY_WORDS, JSON.stringify(words));
  alert("Kelime Sisteme Eklendi!");
}
</script>
</body>
</html>