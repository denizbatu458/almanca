<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Pro Dil Paneli</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">

<style>
:root{
  --bg1:#0f172a; --bg2:#020617;
  --panel:rgba(30, 41, 59, 0.7);
  --border:rgba(255,255,255,.1);
  --accent:#3b82f6; --accent2:#60a5fa;
  --ok:#10b981; --warn:#f59e0b;
  --text:#f8fafc; --muted:#94a3b8;
}
*{box-sizing:border-box}
body{
  margin:0; font-family:Inter,sans-serif;
  background: radial-gradient(circle at top right, #1e293b, #020617);
  color:var(--text); min-height:100vh;
}

.app{display:flex; min-height:100vh}

/* DRAWER */
.drawer{
  width:320px; background:rgba(15, 23, 42, 0.8);
  border-right:1px solid var(--border); padding:20px; backdrop-filter:blur(10px);
}
.admin-pill{
  display:flex; align-items:center; gap:10px; padding:12px;
  border-radius:12px; border:1px solid var(--border);
  background:rgba(255,255,255,.03); cursor:pointer; margin-bottom:20px;
}
.admin-dot{width:10px; height:10px; border-radius:50%; background:#ef4444;}
.admin-dot.on{background:var(--ok); box-shadow:0 0 10px var(--ok);}

.unit-title{font-weight:800; color:var(--accent2); margin:20px 0 8px; font-size:12px; letter-spacing:1px; text-transform:uppercase;}
.section{
  padding:12px; border-radius:10px; background:rgba(255,255,255,.03);
  border:1px solid var(--border); cursor:pointer; margin-bottom:6px; font-size:14px;
}
.section.active{background:var(--accent); color:#fff; border-color:var(--accent2);}

/* CONTENT */
.content{flex:1; padding:40px; display:flex; justify-content:center;}
.wrap{width:100%; max-width:800px; background:var(--panel); padding:35px; border-radius:24px; border:1px solid var(--border); box-shadow:0 25px 50px -12px rgba(0,0,0,0.5);}

/* COMPONENTS */
input, select, textarea {
  width:100%; padding:12px; margin-top:8px; border-radius:10px;
  background:#0f172a; border:1px solid var(--border); color:#fff; outline:none;
}
button{
  width:100%; padding:14px; margin-top:15px; border-radius:10px;
  border:none; background:var(--accent); color:#fff; font-weight:700; cursor:pointer;
}
button.danger{background:#ef4444;}
button.ghost{background:transparent; border:1px solid var(--border);}

.word-bank{display:flex; flex-wrap:wrap; gap:8px; margin:15px 0; padding:15px; background:rgba(0,0,0,0.2); border-radius:12px;}
.word-item{padding:8px 16px; background:rgba(255,255,255,0.1); border:1px solid var(--border); border-radius:8px; cursor:pointer; transition:0.2s;}
.word-item:hover{background:var(--accent);}

/* MODAL */
.modal-backdrop{
  position:fixed; inset:0; background:rgba(0,0,0,.9);
  display:none; align-items:center; justify-content:center; z-index:1000; padding:20px;
}
.modal{
  width:100%; max-width:650px; background:#0f172a; border:1px solid var(--border);
  border-radius:20px; max-height:90vh; overflow-y:auto; padding:30px;
}

.q-card{
  background:rgba(255,255,255,.03); padding:15px; border-radius:12px;
  margin-bottom:12px; border:1px solid var(--border);
}
</style>
</head>
<body>

<div class="app">
  <div class="drawer">
    <div class="admin-pill" onclick="handleAdminClick()">
      <div id="adminDot" class="admin-dot"></div>
      <div>
        <b style="display:block; font-size:13px;">YÃ¶netim Paneli</b>
        <small id="adminStatus" style="color:var(--muted)">Åžifre Gerekli</small>
      </div>
    </div>
    <div id="unitList"></div>
  </div>

  <div class="content">
    <div class="wrap">
      <div id="qBox">
        <h2 style="text-align:center; color:var(--muted); margin-top:50px;">HoÅŸ Geldiniz!<br><small>LÃ¼tfen soldan bir ders seÃ§in.</small></h2>
      </div>
    </div>
  </div>
</div>

<div id="adminPanelModal" class="modal-backdrop">
  <div class="modal">
    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
      <h2>ðŸ›  Ä°Ã§erik Ãœreticisi</h2>
      <button class="ghost" style="width:auto; margin:0;" onclick="closeModal('adminPanelModal')">Kapat</button>
    </div>

    <div style="background:rgba(255,255,255,0.02); padding:20px; border-radius:15px; border:1px solid var(--border);">
      <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px;">
        <select id="qLevel">
            <option value="A1.1">A1.1</option><option value="A1.2">A1.2</option>
            <option value="A2.1">A2.1</option><option value="A2.2">A2.2</option>
            <option value="B1.1">B1.1</option><option value="B2.1">B2.1</option>
        </select>
        <input id="qUnit" placeholder="Ãœnite AdÄ± (A1.1 Ãœnite 1)">
      </div>
      <input id="qSection" placeholder="Ders/BÃ¶lÃ¼m AdÄ± (Ders 1: TanÄ±ÅŸma)">
      
      <select id="qType" onchange="toggleTypeInfo()">
        <option value="word_match">Ã‡oktan SeÃ§meli</option>
        <option value="text_fill">Yazarak Cevaplama</option>
        <option value="audio_fill">ðŸŽ§ Ses Dinle & Yaz</option>
        <option value="word_bank">ðŸ§© Kelime BankasÄ± (BoÅŸluk Doldurma)</option>
      </select>

      <div id="typeHint" style="font-size:11px; color:var(--warn); margin-top:5px; padding-left:5px;"></div>

      <textarea id="qQuestion" placeholder="Soru veya CÃ¼mle (BoÅŸluk iÃ§in ____ kullanÄ±n)"></textarea>
      <input id="qMedia" placeholder="Ses DosyasÄ± Linki (Sadece Sesli Soru Ä°Ã§in)">
      <textarea id="qOptions" placeholder="SeÃ§enekler veya Kelime BankasÄ± (VirgÃ¼lle ayÄ±rÄ±n)"></textarea>
      <input id="qAnswer" placeholder="DoÄŸru Cevap">
      
      <button onclick="addNewQuestion()">Ä°Ã§eriÄŸi YayÄ±nla</button>
    </div>

    <div style="margin-top:30px;">
      <b>YayÄ±nlanan Sorular</b>
      <div id="adminQuestionList" style="margin-top:15px;"></div>
    </div>
  </div>
</div>

<div id="passModal" class="modal-backdrop">
  <div class="modal" style="max-width:350px">
    <h3>ðŸ”’ GÃ¼venli Alan</h3>
    <input type="password" id="adminPassInput" placeholder="Sistem Åžifresi">
    <button onclick="checkAdminPass()">Yetkilendir</button>
  </div>
</div>

<script>
const ADMIN_PASS = "1907";
const KEY_BANK = "practice_bank_v3"; // Yeni versiyon iÃ§in key gÃ¼ncellendi
let isAdmin = false;
let active = { unit: null, section: null, index: 0 };

// YardÄ±mcÄ±lar
const getBank = () => JSON.parse(localStorage.getItem(KEY_BANK)) || [];
const saveBank = (d) => localStorage.setItem(KEY_BANK, JSON.stringify(d));
const openModal = (id) => document.getElementById(id).style.display = "flex";
const closeModal = (id) => document.getElementById(id).style.display = "none";

function handleAdminClick() {
  isAdmin ? (openModal('adminPanelModal'), renderAdminQuestions()) : openModal('passModal');
}

function checkAdminPass() {
  if(document.getElementById("adminPassInput").value === ADMIN_PASS) {
    isAdmin = true;
    document.getElementById("adminDot").classList.add("on");
    document.getElementById("adminStatus").textContent = "EriÅŸim AÃ§Ä±k";
    closeModal('passModal');
    renderAdminQuestions();
  } else alert("HatalÄ±!");
}

function toggleTypeInfo() {
  const type = document.getElementById("qType").value;
  const hint = document.getElementById("typeHint");
  if(type === "audio_fill") hint.textContent = "CevabÄ± yazÄ±lacak ses dosyasÄ±nÄ±n URL'sini medya kÄ±smÄ±na yapÄ±ÅŸtÄ±rÄ±n.";
  else if(type === "word_bank") hint.textContent = "Kelime bankasÄ±ndaki tÃ¼m kelimeleri 'SeÃ§enekler' kÄ±smÄ±na virgÃ¼lle yazÄ±n.";
  else hint.textContent = "";
}

function addNewQuestion() {
  const q = {
    id: "ID" + Date.now(),
    level: document.getElementById("qLevel").value,
    unit: document.getElementById("qUnit").value.trim(),
    section: document.getElementById("qSection").value.trim(),
    type: document.getElementById("qType").value,
    question: document.getElementById("qQuestion").value.trim(),
    media: document.getElementById("qMedia").value.trim(),
    options: document.getElementById("qOptions").value.trim(),
    answer: document.getElementById("qAnswer").value.trim()
  };

  if(!q.unit || !q.question || !q.answer) return alert("Eksikleri tamamla!");
  
  const bank = getBank();
  bank.push(q);
  saveBank(bank);
  alert("BaÅŸarÄ±yla eklendi!");
  renderAdminQuestions();
  renderSidebar();
}

function deleteQuestion(id) {
  if(!confirm("Bu soruyu tamamen silmek istiyor musun?")) return;
  const bank = getBank().filter(item => item.id !== id);
  saveBank(bank);
  renderAdminQuestions();
  renderSidebar();
}

function renderSidebar() {
  const bank = getBank();
  const structure = {};
  bank.forEach(q => {
    if(!structure[q.unit]) structure[q.unit] = new Set();
    structure[q.unit].add(q.section);
  });

  const list = document.getElementById("unitList");
  list.innerHTML = "";
  for(const unit in structure) {
    list.innerHTML += `<div class="unit-title">${unit}</div>`;
    structure[unit].forEach(sec => {
      const activeClass = (active.unit === unit && active.section === sec) ? 'active' : '';
      list.innerHTML += `<div class="section ${activeClass}" onclick="selectSection('${unit}','${sec}')">${sec}</div>`;
    });
  }
}

function selectSection(u, s) {
  active = { unit: u, section: s, index: 0 };
  renderSidebar();
  renderQuestion();
}

function renderQuestion() {
  const qs = getBank().filter(q => q.unit === active.unit && q.section === active.section);
  const box = document.getElementById("qBox");
  if(active.index >= qs.length) {
    box.innerHTML = "<h2>ðŸŽ‰ Tebrikler! BÃ¶lÃ¼m bitti.</h2><button onclick='location.reload()'>DiÄŸer BÃ¶lÃ¼mlere GeÃ§</button>";
    return;
  }

  const q = qs[active.index];
  let html = `<small style="color:var(--accent2)">${active.unit} / ${active.section}</small>
              <h2 style="margin-top:10px;">${q.question.replace("____", " (......) ")}</h2>`;

  if(q.type === "audio_fill") {
    html += `<audio controls src="${q.media}" style="width:100%; margin:20px 0;"></audio>
             <input id="userInp" placeholder="DuyduÄŸunu yaz...">`;
  } else if(q.type === "word_bank") {
    html += `<div class="word-bank">`;
    q.options.split(",").forEach(w => {
      html += `<div class="word-item" onclick="document.getElementById('userInp').value = '${w.trim()}'">${w.trim()}</div>`;
    });
    html += `</div><input id="userInp" readonly placeholder="YukarÄ±dan kelime seÃ§...">`;
  } else if(q.type === "word_match") {
    html += `<div style="display:grid; gap:10px; margin-top:20px;">`;
    q.options.split(",").forEach(opt => {
      html += `<button class="ghost" onclick="checkAnswer('${opt.trim()}', '${q.answer}')">${opt.trim()}</button>`;
    });
    html += `</div>`;
  } else {
    html += `<input id="userInp" placeholder="CevabÄ±nÄ± yaz...">`;
  }

  if(q.type !== "word_match") {
    html += `<button onclick="checkAnswer(document.getElementById('userInp').value, '${q.answer}')">Kontrol Et</button>`;
  }

  box.innerHTML = html;
}

function checkAnswer(u, c) {
  if(u.toLowerCase().trim() === c.toLowerCase().trim()) {
    alert("DoÄŸru! ðŸŒŸ");
    active.index++;
    renderQuestion();
  } else alert("Tekrar Dene! âŒ");
}

function renderAdminQuestions() {
  const list = document.getElementById("adminQuestionList");
  const bank = getBank();
  list.innerHTML = "";
  bank.slice().reverse().forEach(q => {
    list.innerHTML += `
      <div class="q-card">
        <div style="display:flex; justify-content:space-between;">
          <small>${q.level} - ${q.unit}</small>
          <button class="danger" style="width:auto; margin:0; padding:4px 8px; font-size:10px;" onclick="deleteQuestion('${q.id}')">Sil</button>
        </div>
        <div style="margin-top:8px;">${q.question}</div>
        <div style="color:var(--ok); font-size:12px; margin-top:5px;">Cevap: ${q.answer}</div>
      </div>
    `;
  });
}

renderSidebar();
</script>
</body>
</html>